module.exports = function (path, log) {
    var request = require('request');
    var module = {};

    //settings
    module.name = "sample-pushbullet-doorbell";
    module.mac = "74:XX:XX:XX:XX:XX";
    module.last_triggered = null;

    //execute function
    module.execute = function() {
        var title = 'Ding Dong';
        var message = 'The doorbell is ringing...';
        
        sendPush(title, message, 'PUSHBULLETEMAIL1');
        sendPush(title, message, 'PUSHBULLETEMAIL2');
        sendPush(title, message, 'PUSHBULLETEMAIL3');
    };


    var sendPush = function (title, message, email) {
        request.post({
            url: 'https://api.pushbullet.com/v2/pushes',
            body: '{ "type" : "note", "title" : "' + title + '", "body" : "' + message + '", "email" : "' + email + '" }',
            headers: { 'Content-Type' : 'application/json', 'Access-Token' : 'PUSHBULLETAPITOKEN' }
        }, function(error, response, body){
                log(module.name, 'Push sent to: ' + email + '\r\n\t' + body);
        });
    };

    return module;
};

